<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>Formul√°rio ‚Äì Atendimento Jur√≠dico Especializado</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
  <style>
    :root{
      --bg:#0f1222; --card:#171a2e; --ink:#e9ecff; --muted:#a9b0d6;
      --pri:#6c8cff; --pri-ink:#0a0e2b; --warn:#ffd166; --border:#2a2e4b;
      --accent:#b8c6ff;
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--ink);font-family:'Montserrat',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;line-height:1.5}
    .wrap{max-width:980px;margin:24px auto;padding:0 16px}

    /* HEADER */
    .hero{background:linear-gradient(180deg,#1c203d,#12152a);border:1px solid var(--border);border-radius:16px;padding:18px 18px 22px;margin-bottom:18px}
    .brand{display:flex;flex-direction:column;align-items:center;gap:10px}
    .brand picture,.brand img{display:block}
    .brand img{max-width:280px;width:100%;height:auto;object-fit:contain;filter:drop-shadow(0 2px 2px rgba(0,0,0,.3))}
    .brand h1{margin:0 0 6px;font-weight:800;letter-spacing:.8px;text-align:center}
    .oabs{font-size:.82rem;color:var(--muted);margin-top:8px;text-align:right}
    .subtitle{margin:.35rem 0 0;color:#fff;font-weight:700;text-align:center;font-size:1.08rem}

    /* CARDS */
    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:20px;margin:14px 0}
    .grid{display:grid;gap:12px}
    @media (min-width:720px){ .grid.cols-2{grid-template-columns:1fr 1fr} }
    label{display:block;font-size:.88rem;color:var(--muted);margin:4px 0 6px}
    input,select,textarea{width:100%;background:#0f1330;color:var(--ink);border:1px solid var(--border);border-radius:10px;padding:12px 12px;outline:none}
    textarea{min-height:96px;resize:vertical}
    .section-title{margin:0 0 8px;font-weight:700;font-size:1.06rem}
    .hide{display:none}
    .btns{display:flex;gap:12px;flex-wrap:wrap}
    .btn{appearance:none;border:0;border-radius:12px;padding:12px 16px;font-weight:700;cursor:pointer;background:var(--pri);color:var(--pri-ink)}
    .req::after{content:" *";color:var(--warn);font-weight:700}
    .callout{background:#13273a;border:1px solid #1b3953;padding:12px 14px;border-radius:12px;margin-top:16px}
    a{color:var(--accent);text-decoration:none}
    footer{text-align:center;margin:30px 0 20px;color:var(--muted);font-size:.85rem}

    /* Pills & chips */
    .pill{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border:1px solid var(--border);border-radius:999px;margin:6px 8px 0 0;user-select:none}
    .pill input{width:18px;height:18px;margin:0}
    .chips{display:flex;gap:10px;flex-wrap:wrap}
    .chip{display:inline-flex;align-items:center;gap:8px;border:1px solid var(--border);padding:10px 12px;border-radius:12px;min-height:44px}
    .chip input{width:18px;height:18px;margin:0}

    hr.sep{border:0;border-top:1px dashed var(--border);margin:14px 0}
  </style>
</head>
<body>
  <div class="wrap">
    <!-- HEADER -->
    <section class="hero" aria-label="Identidade">
      <div class="brand">
        <!-- LOGO com fallback autom√°tico -->
        <picture>
          <!-- fontes webp/png ser√£o definidas via JS; aqui vai um fallback m√≠nimo -->
          <img id="jg-logo" alt="Logo Juliano Garbuggio" width="280" height="120"
               src="" style="background:transparent" />
        </picture>
        <h1>JULIANO GARBUGGIO | ADVOCACIA &amp; CONSULTORIA</h1>
      </div>
      <div class="oabs">OAB/SP 505.598 &nbsp;|&nbsp; OAB/PR 47.565 &nbsp;|&nbsp; OAB/MG 234.362</div>
      <p class="subtitle">Preencha seus dados para atendimento especializado.</p>
    </section>

    <form id="form" novalidate>
      <!-- CONTEXTO -->
      <section class="card">
        <h2 class="section-title">1) Contexto do Atendimento</h2>
        <div class="grid cols-2">
          <div>
            <label class="req" for="motivo">Motivo do atendimento</label>
            <select id="motivo" required>
              <option value="cadastro">1 ‚Äî Atualiza√ß√£o de cadastro | Procura√ß√£o</option>
              <option value="emprestimos">2 ‚Äî Info Revis√µes de Empr√©stimos (bancos)</option>
              <option value="outras_acoes">3 ‚Äî Info Outras A√ß√µes</option>
              <option value="duvidas">4 ‚Äî Outras d√∫vidas, sugest√µes, cr√≠ticas</option>
            </select>
          </div>
          <div id="tipo_wrap">
            <label class="req">Tipo de contato</label>
            <div>
              <label class="pill"><input type="radio" name="tipo" value="Consignado INSS" required> Consignado INSS</label>
              <label class="pill"><input type="radio" name="tipo" value="Consignado p√∫blico/privado"> Consignado p√∫blico/privado</label>
              <label class="pill"><input type="radio" name="tipo" value="Financiamento banc√°rio"> Financiamento banc√°rio</label>
              <label class="pill"><input type="radio" name="tipo" value="Direito Digital"> Direito Digital</label>
              <label class="pill"><input type="radio" name="tipo" value="Direito M√©dico"> Direito M√©dico</label>
              <label class="pill"><input type="radio" name="tipo" value="Outros casos Direito Consumidor | Civil"> Outros casos Direito Consumidor | Civil</label>
              <label class="pill"><input type="radio" name="tipo" value="D√∫vida geral"> D√∫vida geral</label>
            </div>
          </div>
        </div>
      </section>

      <!-- SIMPLES (motivos 2,3,4) -->
      <section class="card" id="sec-simples">
        <h2 class="section-title">2) Dados para contato</h2>
        <div class="grid cols-2">
          <div><label class="req" for="nome_s">Nome completo</label><input id="nome_s" required></div>
          <div><label class="req" for="cpf_s">CPF</label><input id="cpf_s" placeholder="000.000.000-00" required></div>

          <!-- Identifica√ß√£o complementar (opcional) ‚Äì SIMPLES -->
          <div style="grid-column:1/-1">
            <label>Identifica√ß√£o complementar (opcional)</label>
            <div class="pill"><input type="checkbox" id="toggle_ident_s"> <span>Mostrar campos</span></div>
          </div>
          <div id="ident-comp-bloco-s" class="hide" style="grid-column:1/-1">
            <div class="grid cols-2">
              <div><label for="nome_social_s">Nome social</label><input id="nome_social_s" placeholder="Opcional"></div>
              <div><label for="pronomes_s">Pronomes (ex.: ela/dela, ele/dele, elu/delu)</label><input id="pronomes_s" placeholder="Opcional"></div>
            </div>
            <hr class="sep">
          </div>

          <!-- Identidade de g√™nero (opcional) ‚Äì SIMPLES -->
          <div style="grid-column:1/-1">
            <label>Auto Declara√ß√£o ‚Äì Identidade de G√™nero (opcional)</label>
            <div class="pill"><input type="checkbox" id="toggle_genero_s"> <span>Mostrar op√ß√µes</span></div>
            <div id="genero-opcoes-s" class="hide" style="margin-top:10px">
              <div class="chips">
                <label class="chip"><input type="checkbox" value="Mulher cisg√™nera"> Mulher cisg√™nera</label>
                <label class="chip"><input type="checkbox" value="Homem cisg√™nero"> Homem cisg√™nero</label>
                <label class="chip"><input type="checkbox" value="Mulher transg√™nera"> Mulher transg√™nera</label>
                <label class="chip"><input type="checkbox" value="Homem transg√™nero"> Homem transg√™nero</label>
                <label class="chip"><input type="checkbox" value="Travesti"> Travesti</label>
                <label class="chip"><input type="checkbox" value="N√£o-bin√°rie"> N√£o-bin√°rie</label>
                <label class="chip"><input type="checkbox" value="Prefiro n√£o dizer"> Prefiro n√£o dizer</label>
                <label class="chip">Outro: <input id="genero_outro_s" placeholder="especifique" style="width:220px"></label>
              </div>
            </div>
          </div>

          <div><label class="req" for="cel_s">WhatsApp</label><input id="cel_s" placeholder="(11) 9xxxx-xxxx" required></div>
          <div><label for="email_s">E-mail</label><input id="email_s" type="email" placeholder="voce@email.com"></div>
          <div><label class="req" for="cep_s">CEP</label><input id="cep_s" placeholder="00000-000" required></div>
          <div><label class="req" for="cidadeuf_s">Cidade/UF</label><input id="cidadeuf_s" placeholder="Cidade/UF" required></div>
          <div class="cols-2" style="grid-column:1/-1">
            <label for="breve">Relate brevemente o motivo do contato</label>
            <textarea id="breve" placeholder="Ex.: cobran√ßa indevida, d√∫vida sobre contrato, etc."></textarea>
          </div>
        </div>
      </section>

      <!-- COMPLETO (motivo 1) -->
      <section class="card hide" id="sec-completo">
        <h2 class="section-title">2) Dados pessoais</h2>
        <div class="grid cols-2">
          <div><label class="req" for="nome">Nome completo</label><input id="nome"></div>

          <!-- Identifica√ß√£o complementar (opcional) ‚Äì COMPLETO -->
          <div style="grid-column:1/-1">
            <label>Identifica√ß√£o complementar (opcional)</label>
            <div class="pill"><input type="checkbox" id="toggle_ident"> <span>Mostrar campos</span></div>
          </div>
          <div id="ident-comp-bloco" class="hide" style="grid-column:1/-1">
            <div class="grid cols-2">
              <div><label for="nome_social">Nome social</label><input id="nome_social" placeholder="Opcional"></div>
              <div><label for="pronomes">Pronomes (ex.: ela/dela, ele/dele, elu/delu)</label><input id="pronomes" placeholder="Opcional"></div>
            </div>
            <hr class="sep">
          </div>

          <div>
            <label class="req" for="nacionalidade">Nacionalidade</label>
            <select id="nacionalidade">
              <option>Brasileiro(a)</option>
              <option>Outros</option>
            </select>
          </div>
          <div id="nac_outros_wrap" class="hide"><label for="nac_outros">Qual?</label><input id="nac_outros"></div>

          <div><label class="req" for="nasc">Data de nascimento (dd/mm/aaaa)</label><input id="nasc" placeholder="dd/mm/aaaa" inputmode="numeric" maxlength="10"></div>

          <div>
            <label class="req" for="ec">Estado civil</label>
            <select id="ec">
              <option value="">Selecione‚Ä¶</option>
              <option>Solteira(o)</option>
              <option>Casada(o)</option>
              <option>Uni√£o est√°vel</option>
              <option>Divorciada(o)</option>
              <option>Vi√∫va(o)</option>
            </select>
          </div>

          <div>
            <label class="req" for="prof">Profiss√£o</label>
            <select id="prof">
              <option value="">Selecione a profiss√£o</option>
              <optgroup label="√Årea Administrativa e Financeira">
                <option>Administrador</option><option>Assistente Administrativo</option><option>Secret√°rio(a)</option><option>Contador</option><option>Analista Financeiro</option><option>Gestor de RH</option><option>Auxiliar de Escrit√≥rio</option><option>Recepcionista</option><option>Office Boy / Mensageiro</option><option>Economista</option><option>Funcion√°rio P√∫blico</option>
              </optgroup>
              <optgroup label="√Årea T√©cnica e Industrial">
                <option>Engenheiro Civil</option><option>Engenheiro El√©trico</option><option>T√©cnico em Edifica√ß√µes</option><option>T√©cnico em Mec√¢nica</option><option>T√©cnico em Eletr√¥nica</option><option>Mec√¢nico</option><option>Eletricista</option><option>Encanador</option><option>Operador de M√°quinas</option><option>Soldador</option>
              </optgroup>
              <optgroup label="Com√©rcio e Servi√ßos">
                <option>Comerciante</option><option>Vendedor</option><option>Representante Comercial</option><option>Caixa</option><option>Supervisor de Vendas</option><option>Gar√ßom / Gar√ßonete</option><option>Balconista</option><option>Atendente</option><option>Motorista</option><option>Entregador</option>
              </optgroup>
              <optgroup label="Sa√∫de e Bem-Estar">
                <option>M√©dico</option><option>Enfermeiro</option><option>T√©cnico de Enfermagem</option><option>Dentista</option><option>Fisioterapeuta</option><option>Psic√≥logo</option><option>Nutricionista</option><option>Farmac√™utico</option><option>Cuidador de Idosos</option><option>Esteticista</option><option>Biom√©dico</option>
              </optgroup>
              <optgroup label="Educa√ß√£o e Cultura">
                <option>Professor</option><option>Pedagogo</option><option>Bibliotec√°rio</option><option>Coordenador Escolar</option><option>Instrutor / Educador Social</option><option>Tradutor / Int√©rprete</option>
              </optgroup>
              <optgroup label="Constru√ß√£o Civil">
                <option>Pedreiro</option><option>Servente</option><option>Mestre de Obras</option><option>Pintor</option><option>Carpinteiro</option><option>Azulejista</option><option>Jardineiro</option>
              </optgroup>
              <optgroup label="Tecnologia da Informa√ß√£o">
                <option>Analista de Sistemas</option><option>Desenvolvedor</option><option>Programador</option><option>Suporte T√©cnico</option><option>T√©cnico de Inform√°tica</option><option>Designer Gr√°fico</option><option>Analista de Dados</option>
              </optgroup>
              <optgroup label="Jur√≠dico e Cont√°bil">
                <option>Advogado</option><option>Estagi√°rio de Direito</option><option>T√©cnico Cont√°bil</option><option>Perito</option><option>Consultor Jur√≠dico</option>
              </optgroup>
              <optgroup label="Beleza, Moda e Est√©tica">
                <option>Cabeleireiro</option><option>Manicure / Pedicure</option><option>Maquiador</option><option>Costureiro</option><option>Designer de Sobrancelhas</option><option>Consultor de Moda</option>
              </optgroup>
              <optgroup label="Seguran√ßa e Transporte">
                <option>Policial</option><option>Bombeiro</option><option>Vigilante</option><option>Seguran√ßa Patrimonial</option><option>Motorista Particular</option><option>Motoboy</option>
              </optgroup>
              <optgroup label="Agricultura e Campo">
                <option>Agricultor</option><option>Pecuarista</option><option>Trabalhador Rural</option><option>Pescador</option><option>Jardineiro</option>
              </optgroup>
              <optgroup label="Turismo e Hotelaria">
                <option>Guia Tur√≠stico</option><option>Agente de Viagens</option><option>Recepcionista de Hotel</option><option>Camareira</option><option>Cozinheiro / Chef</option><option>Gar√ßom</option>
              </optgroup>
              <optgroup label="Artes e Comunica√ß√£o">
                <option>Jornalista</option><option>Publicit√°rio</option><option>Fot√≥grafo</option><option>Designer</option><option>M√∫sico</option><option>Artista Pl√°stico</option><option>Redator</option>
              </optgroup>
              <option value="OUTROS">OUTROS</option>
            </select>
          </div>
          <div id="prof_outros_wrap" class="hide"><label for="prof_outros">Outra profiss√£o</label><input id="prof_outros" placeholder="Especifique"></div>

          <div><label class="req" for="rg">RG</label><input id="rg"></div>
          <div><label class="req" for="rguf">UF do RG</label>
            <select id="rguf">
              <option value="">UF</option>
              <option>AC</option><option>AL</option><option>AP</option><option>AM</option><option>BA</option><option>CE</option><option>DF</option><option>ES</option><option>GO</option><option>MA</option><option>MT</option><option>MS</option><option>MG</option><option>PA</option><option>PB</option><option>PR</option><option>PE</option><option>PI</option><option>RJ</option><option>RN</option><option>RS</option><option>RO</option><option>RR</option><option>SC</option><option>SP</option><option>SE</option><option>TO</option>
            </select>
          </div>
          <div><label class="req" for="cpf">CPF</label><input id="cpf" placeholder="000.000.000-00"></div>
        </div>

        <!-- G√äNERO (toggle √∫nico e est√°vel) -->
        <div style="margin-top:8px">
          <label>Auto Declara√ß√£o ‚Äì Identidade de G√™nero (opcional)</label>
          <div class="pill"><input type="checkbox" id="toggle_genero"> <span>Mostrar op√ß√µes</span></div>
          <div id="genero-opcoes" class="hide" style="margin-top:10px">
            <div class="chips">
              <label class="chip"><input type="checkbox" value="Mulher cisg√™nera"> Mulher cisg√™nera</label>
              <label class="chip"><input type="checkbox" value="Homem cisg√™nero"> Homem cisg√™nero</label>
              <label class="chip"><input type="checkbox" value="Mulher transg√™nera"> Mulher transg√™nera</label>
              <label class="chip"><input type="checkbox" value="Homem transg√™nero"> Homem transg√™nero</label>
              <label class="chip"><input type="checkbox" value="Travesti"> Travesti</label>
              <label class="chip"><input type="checkbox" value="N√£o-bin√°rie"> N√£o-bin√°rie</label>
              <label class="chip"><input type="checkbox" value="Prefiro n√£o dizer"> Prefiro n√£o dizer</label>
              <label class="chip">Outro: <input id="genero_outro" placeholder="especifique" style="width:220px"></label>
            </div>
          </div>
        </div>

        <h2 class="section-title" style="margin-top:14px">Endere√ßo</h2>
        <div class="grid cols-2">
          <div><label class="req" for="cep">CEP</label><input id="cep" placeholder="00000-000"></div>
          <div><label class="req" for="rua">Rua / Avenida</label><input id="rua"></div>
          <div><label class="req" for="num">N√∫mero</label><input id="num"></div>
          <div><label for="compl">Complemento</label><input id="compl"></div>
          <div><label class="req" for="bairro">Bairro</label><input id="bairro"></div>
          <div><label class="req" for="uf">UF</label>
            <select id="uf">
              <option value="">UF</option>
              <option>AC</option><option>AL</option><option>AP</option><option>AM</option><option>BA</option><option>CE</option><option>DF</option><option>ES</option><option>GO</option><option>MA</option><option>MT</option><option>MS</option><option>MG</option><option>PA</option><option>PB</option><option>PR</option><option>PE</option><option>PI</option><option>RJ</option><option>RN</option><option>RS</option><option>RO</option><option>RR</option><option>SC</option><option>SP</option><option>SE</option><option>TO</option>
            </select>
          </div>
          <div><label class="req" for="cidade">Cidade</label><input id="cidade"></div>
        </div>

        <h2 class="section-title" style="margin-top:14px">Contato</h2>
        <div class="grid cols-2">
          <div><label class="req" for="ddd">WhatsApp ‚Äî DDD</label><input id="ddd" placeholder="11"></div>
          <div><label class="req" for="cel">N√∫mero</label><input id="cel" placeholder="95675-9223"></div>
          <div><label class="req" for="email">E-mail</label><input id="email" type="email" placeholder="voce@email.com"></div>
        </div>
      </section>

      <!-- LGPD -->
      <section class="card callout">
        <p><strong>Envio direto ao WhatsApp Business de Juliano Garbuggio:</strong> ao prosseguir, o conte√∫do ser√° preparado para envio no aplicativo. Seus dados ser√£o tratados exclusivamente para fins de atendimento confidencial de seu caso, conforme a LGPD (Lei n¬∫ 13.709/2018) e o art. 25 do C√≥digo de √âtica da OAB (sigilo profissional).</p>
        <label><input type="checkbox" id="lgpd" required> Li e concordo com o Aviso de Privacidade acima e autorizo o envio desta solicita√ß√£o via WhatsApp Business (+55 11 95675-9223).</label>
      </section>

      <section class="card"><div class="btns"><button class="btn" id="btn-enviar" type="submit">Salvar + Enviar WhatsApp</button></div></section>
    </form>

    <footer>
      ¬© 2025 Juliano Garbuggio ‚Äì Advocacia & Consultoria ‚Äî <a href="https://www.julianogarbuggio.adv.br" target="_blank">www.julianogarbuggio.adv.br</a> ‚Äî <a href="https://wa.me/5511956759223" target="_blank">(11) 95675-9223</a><br>
      Juliano Garbuggio Sociedade Individual de Advocacia ‚Äî OAB/SP 54.923 | CNPJ 35.142.789/0001-08
    </footer>
  </div>

  <script>
    /* ======== CONFIG DA LOGO ========
       Se quiser EMBUTIR a logo (base64), cole em LOGO_DATA_URI.
       Caso deixe vazio, o script tenta estes arquivos (nesta ordem):
       'logo-juliano-garbuggio.png',
       'logo-juliano-garbuggio.png.webp',
       'logobranca_juliano_garbuggio.webp',
       '/logo-juliano-garbuggio.png'
    */
    const LOGO_DATA_URI = ""; // ex.: "data:image/png;base64,iVBORw0K..." (opcional)

    const logoCandidates = [
      'logo-juliano-garbuggio.png',
      'logo-juliano-garbuggio.png.webp',
      'logobranca_juliano_garbuggio.webp',
      '/logo-juliano-garbuggio.png'
    ];

    function loadFirstWorkingImage(candidates){
      return new Promise(resolve=>{
        if(LOGO_DATA_URI){ return resolve(LOGO_DATA_URI); }
        let idx=0;
        const tryLoad=()=>{
          if(idx>=candidates.length){ return resolve(''); }
          const url=candidates[idx++], img=new Image();
          img.onload=()=>resolve(url);
          img.onerror=tryLoad;
          img.src=url+'?v='+Date.now(); // bust cache
        };
        tryLoad();
      });
    }

    loadFirstWorkingImage(logoCandidates).then(src=>{
      const el=document.getElementById('jg-logo');
      if(src){ el.src=src; el.removeAttribute('aria-hidden'); }
      else{
        // Fallback textual (nunca fica sem identidade visual)
        el.outerHTML = '<div style="width:100%;max-width:280px;text-align:center;font-weight:800;letter-spacing:.06em;">Juliano Garbuggio</div>';
      }
    });

    /* ======== Helpers / m√°scaras / valida√ß√µes ======== */
    const $  = (s)=>document.querySelector(s);
    const $$ = (s)=>Array.from(document.querySelectorAll(s));
    const isMobile = ()=> /Android|iPhone|iPad|iPod|Mobile/i.test(navigator.userAgent);
    const isiOS    = ()=> /iPhone|iPad|iPod/i.test(navigator.userAgent);

    const maskCPF=(el)=>{let v=el.value.replace(/\D/g,'').slice(0,11);el.value=v.replace(/^(\d{3})(\d{3})(\d{3})(\d{0,2}).*/,"$1.$2.$3-$4")};
    const maskCEP=(el)=>{let v=el.value.replace(/\D/g,'').slice(0,8);el.value=v.replace(/^(\d{5})(\d{0,3}).*/,"$1-$2")};
    const maskDDD=(el)=>el.value=el.value.replace(/\D/g,'').slice(0,2);
    const maskFone=(el)=>el.value=el.value.replace(/\D/g,'').slice(0,9).replace(/^(\d{5})(\d{4}).*/,"$1-$2");
    const maskData=(el)=>{let v=el.value.replace(/\D/g,'').slice(0,8);el.value=v.replace(/^(\d{2})(\d{2})(\d{0,4}).*/,"$1/$2/$3")};

    const gerarProtocolo=()=>`JG-${new Date().toISOString().replace(/[-T:.Z]/g,'').slice(0,14)}-${Math.floor(Math.random()*9999)}`;
    const isValidCPF=(cpf)=>{
      cpf=(cpf||'').replace(/\D/g,'');if(cpf.length!==11||/^([0-9])\1+$/.test(cpf))return false;
      let s=0;for(let i=0;i<9;i++)s+=cpf[i]* (10-i);let r=11-(s%11);if(r>=10)r=0;if(r!=cpf[9])return false;
      s=0;for(let i=0;i<10;i++)s+=cpf[i]*(11-i);r=11-(s%11);if(r>=10)r=0;return r==cpf[10];
    };

    async function viaCEP(cep){
      try{ const r=await fetch(`https://viacep.com.br/ws/${cep}/json/`); const j=await r.json(); return j.erro?null:j; }
      catch{return null}
    }
    async function autoCEP(cepEl,cidadeEl,ufEl,ruaEl,bairroEl,cidadeCompactEl){
      const raw=(cepEl.value||'').replace(/\D/g,''); if(raw.length!==8)return;
      const j=await viaCEP(raw); if(!j)return;
      if(cidadeEl)cidadeEl.value=j.localidade||'';
      if(ufEl)ufEl.value=j.uf||'';
      if(ruaEl)ruaEl.value=j.logradouro||'';
      if(bairroEl)bairroEl.value=j.bairro||'';
      if(cidadeCompactEl)cidadeCompactEl.value=`${j.localidade||''}/${j.uf||''}`;
    }

    function coleta(modo){
      const obj={motivo:$('#motivo').value};
      if(modo==='simples'){
        obj.nome=$('#nome_s').value.trim();
        obj.cpf=$('#cpf_s').value.trim();
        obj.cel=$('#cel_s').value.trim();
        obj.email=$('#email_s').value.trim();
        obj.cep=$('#cep_s').value.trim();
        obj.cidadeuf=$('#cidadeuf_s').value.trim();
        obj.breve=$('#breve').value.trim();
      }else{
        obj.nome=$('#nome').value.trim();
        obj.cpf=$('#cpf').value.trim();
        obj.rg=$('#rg').value.trim();
        obj.rguf=$('#rguf').value;
        obj.nasc=$('#nasc').value.trim();
        obj.prof=$('#prof').value==='OUTROS'?($('#prof_outros').value.trim()||'OUTROS'):$('#prof').value;
        obj.ec=$('#ec').value;
        obj.rua=$('#rua').value.trim();
        obj.num=$('#num').value.trim();
        obj.bairro=$('#bairro').value.trim();
        obj.cidade=$('#cidade').value.trim();
        obj.uf=$('#uf').value;
        obj.ddd=$('#ddd').value.trim();
        obj.cel=$('#cel').value.trim();
        obj.email=$('#email').value.trim();
        obj.cep=$('#cep').value.trim();
      }
      return obj;
    }

    function montarMsg(d,modo,protocolo){
      let base=[`üìù Novo cadastro ‚Äì *${d.nome}*`,`Motivo: ${$('#motivo').selectedOptions[0].text}`];
      if(modo==='completo'){
        base.push(`CPF: ${d.cpf} | RG: ${d.rg}/${d.rguf}`,`Profiss√£o: ${d.prof}`,`Cidade: ${d.cidade}/${d.uf}`,`WhatsApp: (${d.ddd}) ${d.cel}`,`E-mail: ${d.email}`);
      }else{
        base.push(`CPF: ${d.cpf} | WhatsApp: ${d.cel}`);
        if(d.email)base.push(`E-mail: ${d.email}`);
        if(d.cidadeuf)base.push(`Cidade/UF: ${d.cidadeuf}`);
        if(d.breve)base.push(`Descri√ß√£o: ${d.breve}`);
      }
      base.push(`Protocolo: ${protocolo}`);
      base.push('Li e concordo com o Aviso de Privacidade acima e autorizo o envio desta solicita√ß√£o via WhatsApp Business (+55 11 95675-9223).');
      return base.join('\n');
    }

    function abrirWhatsApp(msg){
      const phone='5511956759223'; // fixo e exclusivo
      const url=`https://wa.me/${phone}?text=${encodeURIComponent(msg)}`;
      if (isMobile()) window.location.assign(url); else window.open(url,'_blank','noopener,noreferrer');
    }

    function toggleModo(){
      const v=$('#motivo').value;
      $('#sec-completo').classList.add('hide');
      $('#sec-simples').classList.add('hide');
      $('#tipo_wrap').classList.add('hide');

      if(v==='cadastro'){ // 1
        $('#sec-completo').classList.remove('hide');
      } else if(v==='emprestimos'){ // 2
        $('#sec-simples').classList.remove('hide');
        $('#tipo_wrap').classList.remove('hide');
      } else { // 3 e 4
        $('#sec-simples').classList.remove('hide');
      }
    }

    function binds(){
      // toggles compactos (est√°veis no mobile)
      $('#toggle_ident')?.addEventListener('change',e=>$('#ident-comp-bloco').classList.toggle('hide', !e.target.checked));
      $('#toggle_ident_s')?.addEventListener('change',e=>$('#ident-comp-bloco-s').classList.toggle('hide', !e.target.checked));
      $('#toggle_genero')?.addEventListener('change',e=>$('#genero-opcoes').classList.toggle('hide', !e.target.checked));
      $('#toggle_genero_s')?.addEventListener('change',e=>$('#genero-opcoes-s').classList.toggle('hide', !e.target.checked));

      // m√°scaras
      $('#cpf')?.addEventListener('input',e=>maskCPF(e.target));
      $('#cpf_s')?.addEventListener('input',e=>maskCPF(e.target));
      $('#nasc')?.addEventListener('input',e=>maskData(e.target));
      $('#ddd')?.addEventListener('input',e=>maskDDD(e.target));
      $('#cel')?.addEventListener('input',e=>maskFone(e.target));
      $('#cep')?.addEventListener('input',e=>maskCEP(e.target));
      $('#cep_s')?.addEventListener('input',e=>maskCEP(e.target));
      $('#cep')?.addEventListener('blur',()=>autoCEP($('#cep'),$('#cidade'),$('#uf'),$('#rua'),$('#bairro')));
      $('#cep_s')?.addEventListener('blur',()=>autoCEP($('#cep_s'),null,null,null,null,$('#cidadeuf_s')));

      // extras
      $('#nacionalidade')?.addEventListener('change',()=>$('#nac_outros_wrap').classList.toggle('hide', $('#nacionalidade').value!=='Outros'));
      $('#prof')?.addEventListener('change',()=>$('#prof_outros_wrap').classList.toggle('hide', $('#prof').value!=='OUTROS'));

      // altern√¢ncia
      $('#motivo')?.addEventListener('change',toggleModo);
      toggleModo();

      // submit
      $('#form').addEventListener('submit',e=>{
        e.preventDefault();
        if(!$('#lgpd').checked){ alert('Voc√™ deve concordar com o Aviso de Privacidade.'); return; }
        const v=$('#motivo').value;
        const modo=(v==='cadastro')?'completo':'simples';
        const d=coleta(modo);

        // valida√ß√µes essenciais
        if(!d.nome){alert('Preencha o nome.');return;}
        if(!d.cpf || !isValidCPF(d.cpf)){alert('CPF inv√°lido.');return;}
        if(modo==='completo'){
          if(!d.ddd || !/^\d{2}$/.test(d.ddd)){alert('DDD inv√°lido.');return;}
          if(!d.cel || d.cel.replace(/\D/g,'').length!==9){alert('WhatsApp inv√°lido.');return;}
        }else{
          const celRaw=d.cel.replace(/\D/g,'');
          if(!(celRaw.length===11 || celRaw.length===9)){alert('WhatsApp inv√°lido.');return;}
        }

        const protocolo=gerarProtocolo();
        const msg=montarMsg(d,modo,protocolo);
        abrirWhatsApp(msg);
      });
    }
    document.readyState==='loading'?document.addEventListener('DOMContentLoaded',binds):binds();
  </script>
</body>
</html>